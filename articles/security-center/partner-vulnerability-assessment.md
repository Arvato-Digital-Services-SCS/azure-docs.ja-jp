---
title: Azure Security Center でのパートナーの脆弱性スキャナー
description: Azure Security Center は、サードパーティの脆弱性評価ソリューションの統合をサポートしています。 この記事では、そのようなツールの設定方法について説明します。
services: security-center
documentationcenter: na
author: memildin
manager: rkarlin
ms.service: security-center
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 12/13/2019
ms.author: memildin
ms.openlocfilehash: ac68e5a91f72954ce54892f22ab5ba3a7a593bbf
ms.sourcegitcommit: 50ef5c2798da04cf746181fbfa3253fca366feaa
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/30/2020
ms.locfileid: "82611434"
---
# <a name="deploying-a-partner-vulnerability-scanning-solution"></a>パートナーの脆弱性スキャン ソリューションをデプロイする

Standard レベルを使用している場合は、「[仮想マシン向けの統合された脆弱性スキャナー](built-in-vulnerability-assessment.md)」で説明されている、Azure Security Center の組み込みの脆弱性評価ツールを使用できます。 このツールには Qualys ライセンスも Qualys アカウントも必要ありません。すべてが Security Center 内でシームレスに処理されます。

あるいは、[Qualys](https://www.qualys.com/lp/azure) または [Rapid7](https://www.rapid7.com/products/insightvm/) から、プライベートにライセンス供与された独自の脆弱性評価ソリューションをデプロイすることもできます。 これらのパートナー ソリューションのいずれかを、同じサブスクリプションに属する複数の VM にインストールできます。

## <a name="configuring-a-partner-solution-in-the-azure-portal"></a>(Azure portal で) パートナー ソリューションを構成する

1. **Security Center** ダッシュボードの **[概要]** セクションで **[推奨事項]** をクリックします。

1. **[推奨事項]** ページで **[脆弱性評価ソリューションを仮想マシンにインストールする必要があります]** を選択します。

    ![脆弱性評価](./media/security-center-vulnerability-assessment-recommendations/security-center-vulnerability-assessment-fig1-new.png)

1. **[脆弱性評価ソリューションを仮想マシンにインストールする必要があります]** ページで、脆弱性評価ソリューションのインストール先となる VM を選択します。

    ![脆弱性評価ソリューションの追加](./media/security-center-vulnerability-assessment-recommendations/security-center-vulnerability-assessment-fig2-new.png)

1. **[脆弱性評価ソリューションを仮想マシンにインストールする必要があります]** ページで、 **[2 VM にインストール]** をクリックします (この名前は、選択した VM の数によって異なります)。

    ![脆弱性評価の追加](./media/security-center-vulnerability-assessment-recommendations/security-center-vulnerability-assessment-fig3-new.png)

1. 新しい脆弱性評価を作成することも、既存のソリューションを使用することもできます。 新しい脆弱性評価を作成する場合は、**Azure Marketplace** でパートナー ソリューションを選択できます。 または、 **[既存のソリューションの使用]** で **Qualys** か **Rapid7** を選択することもできます。

    Security Center からエージェントをデプロイするには、ベンダーからのライセンス コードと公開キーが必要です。 ライセンス コードと公開キーを取得する方法については、[Qualys のドキュメント](https://community.qualys.com/docs/DOC-5823-deploying-qualys-cloud-agents-from-microsoft-azure-security-center) または [Rapid7 のドキュメント](https://insightvm.help.rapid7.com/docs/azure-security-center)をご覧ください。


1. 新しい評価を作成するには、 **[新規作成]** をクリックします。 パートナーの**脆弱性管理**ページが開きます。 このページに表示されるオプションは、パートナーに応じて変わる可能性があります。

    ![新しい脆弱性評価ソリューションの作成](./media/security-center-vulnerability-assessment-recommendations/security-center-vulnerability-assessment-fig4-new.png)

    たとえば、Qualys を設定する場合は、 **[Qualys]** を選択して、次の操作を実行します。
    
    1. **[リソース グループ]** では、 **[既存のものを使用]** を選択します。
    
    1. **[場所]** では、そのソリューションが地理的に配置されている場所を選択します。
    
    1. **[ライセンス コード]** ボックス (Qualys 固有) に、パートナーから提供されるライセンスを入力します。
    
    1. **[公開キー]** ボックス (Qualys 固有) に、パートナーから提供される公開キー情報を入力します。
    
    1. この Qualys ソリューションのサブスクリプション内で検出されたすべての VM に脆弱性評価エージェントを自動的にインストールするには、 **[自動更新]** チェック ボックスをオンにします。
    
    1. **[OK]** をクリックします。


## <a name="configuring-a-partner-solution-using-powershell-and-the-rest-api"></a>(PowerShell と REST API を使用して) パートナー ソリューションを構成する

[Qualys](https://www.qualys.com/lp/azure) または [Rapid7](https://www.rapid7.com/products/insightvm/) から、プライベートにライセンス供与された独自の脆弱性評価ソリューションをプログラムでデプロイするには、提供されているスクリプト [PowerShell > 脆弱性ソリューション](https://github.com/Azure/Azure-Security-Center/tree/master/Powershell%20scripts/Vulnerability%20Solution)を使用します。 

このスクリプトでは、REST API を使用して、ASC で新しいセキュリティ ソリューションを作成します。 このソリューションには、サービス プロバイダーによって提供されるライセンスとキーが必要です(Qualys または Rapid7)。

> [!IMPORTANT] 
> ライセンスごとに作成できるソリューションは 1 つだけです。 同じ名前/ライセンス/キーを使用して別のソリューションを作成しようとすると、失敗します。

### <a name="prerequisites"></a>前提条件

以下の PowerShell モジュールが必要です。

- Install-module Az
- Install-module Az.security

### <a name="running-the-script"></a>スクリプトの実行

スクリプトを実行するには、以下のパラメーターに関連する情報が必要です。

| **パラメーター** | **必須** | **メモ** |
|----|:----:|----|
|**SubscriptionId**|✔|分析するリソースを含む Azure サブスクリプションの subscriptionID。|
|**ResourceGroupName**|✔|リソース グループの名前。 既定値 ("DefaultResourceGroup-xxx") を含む既存のリソース グループを使用します。 このソリューションは Azure リソースではないため、リソース グループの下には表示されませんが、まだ添付されています。|
|**vaSolutionName**|✔|新しいソリューションの名前。|
|**vaType**|✔|Qualys または Rapid7。|
|**licenceCode**|✔|ベンダーから提供されたライセンス文字列。|
|**publicKey**|✔|ベンダーから提供された公開キー。|
|**autoUpdate**|-|この VA ソリューションの自動デプロイを有効 (true) または無効 (false) にします。 有効にすると、サブスクリプションのすべての新しい VM が自動的にソリューションへのリンクを試みます。<br/>(既定値:false)|


構文:

```
.\New-ASCVASolution.ps1 -subscriptionId <Subscription Id> -resourceGroupName <RG Name>
-vaSolutionName <New solution name> -vaType <Qualys / Rapid7> -autoUpdate <true/false>
-licenceCode <License code from vendor> -publicKey <Public Key received from vendor>
```

例 (この例には、有効なライセンスの詳細は含まれていません):

```
.\New-ASCVASolution.ps1 -subscriptionId 'f4cx1b69-dtgb-4ch6-6y6f-ea2e95373d3b' -resourceGroupName 'DefaultResourceGroup-WEU' -vaSolutionName 'QualysVa001' -vaType 'Qualys' -autoUpdate 'false' `
-licenceCode 'eyJjaWQiOiJkZDg5OTYzXe4iMTMzLWM4NTAtODM5FD2mZWM1N2Q3ZGU5MjgiLCJgbTYuOiIyMmM5NDg3MS1lNTVkLTQ1OGItYjhlMC03OTRhMmM3YWM1ZGQiLCJwd3NVcmwiOiJodHRwczovL3FhZ3B1YmxpYy1wMDEuaW50LnF1YWx5cy5jb20vQ2xvdSKJY6VudC8iLCJwd3NQb3J0IjoiNDQzIn0=' `
-publicKey 'MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCOiOLXjOywMfLZIBGPZLwSocf1Q64GASLK9OHFEmanBl1nkJhZDrZ4YD5lM98fThYbAx1Rde2iYV1ze/wDlX4cIvFAyXuN7HbdkeIlBl6vWXEBZpUU17bOdJOUGolzEzNBhtxi/elEZLghq9Chmah82me/okGMIhJJsCiTtglVQIDAQAB'
```


## <a name="review-the-recommendation"></a>推奨事項の確認
対象 VM に脆弱性評価ソリューションがインストールされると、Security Center では、VM がスキャンされ、システムとアプリケーションの脆弱性が検出、特定されます。

> [!NOTE]
> 最初のスキャンが完了するまでに数時間かかる場合があります。 その後は、1 時間ほどの処理になります。

検出された問題は、 **[Virtual Machines Recommendations]\(仮想マシンに関する推奨事項\)** に表示されます。

## <a name="next-steps"></a>次のステップ

この記事では、VM をスキャンするために Qualys によって提供される組み込みの脆弱性評価ツールについて説明しました。 関連資料については、次の記事をご覧ください。

- [推奨事項のさまざまな要素に関する詳細](security-center-recommendations.md)
- [推奨事項を修復する方法を確認する](security-center-remediate-recommendations.md)