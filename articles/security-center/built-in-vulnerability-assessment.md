---
title: Azure Security Center の組み込み脆弱性スキャナー
description: Azure Security Center には、完全に統合された Qualys の脆弱性評価ソリューションが含まれています。 このページでは、この Security Center の拡張機能について学習します。
services: security-center
documentationcenter: na
author: memildin
manager: rkarlin
ms.service: security-center
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 03/30/2020
ms.author: memildin
ms.openlocfilehash: 7653a9ce20b1a9e21f44df1ce0d0f2aed32a83e0
ms.sourcegitcommit: 64fc70f6c145e14d605db0c2a0f407b72401f5eb
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/27/2020
ms.locfileid: "83871603"
---
# <a name="integrated-vulnerability-scanner-for-virtual-machines-standard-tier-only"></a>仮想マシン向けの統合された脆弱性スキャナー (Standard レベルのみ)

Azure Security Center に含まれている脆弱性スキャナーは、Qualys を利用しています。 Qualys のスキャナーは、Azure Virtual Machines の脆弱性をリアルタイムで識別するための主要なツールです。 これは、Standard 価格レベルのユーザーのみご利用いただけます。 Qualys ライセンスも Qualys アカウントも必要ありません。すべてが Security Center 内でシームレスに処理されます。

> [!NOTE]
> Security Center では他のベンダーからのツールの統合がサポートされていますが、ライセンスのコスト、デプロイ、および構成について対処する必要があります。 詳細については、「[パートナーの脆弱性スキャン ソリューションをデプロイする](partner-vulnerability-assessment.md)」を参照してください。 Azure Security Center に含まれている組み込みの脆弱性スキャナーを使用しない場合は、これらの手順を使用して組織自体の Qualys ライセンスを統合することもできます。

## <a name="availability"></a>可用性

- リリース状態: **一般提供**
- 必要なロール: **リソース所有者**は、スキャナーをデプロイできます。 **セキュリティ閲覧者**は、結果を表示できます。
- クラウド: 
    - ✔ 商用クラウド
    - ✘ ナショナル/ソブリン (US Gov、China Gov、その他の Gov)


## <a name="overview-of-the-integrated-vulnerability-scanner"></a>統合された脆弱性スキャナーの概要

脆弱性スキャナー拡張機能は、次のように機能します。

1. **デプロイ** - Azure Security Center により、選択した仮想マシンに Qualys 拡張機能が展開されます。

1. **情報収集** - 拡張機能により成果物が収集され、定義されたリージョンの Qualys クラウド サービスでの分析用に送信されます。

1. **分析** - Qualys のクラウド サービスにより脆弱性評価が実施され、その結果が Security Center に送信されます。 

    > [!IMPORTANT]
    > Microsoft は、お客様のプライバシー、機密性、セキュリティを確保するために、お客様の詳細情報を Qualys に共有しません。 [Azure に組み込まれているプライバシー基準の詳細については、こちらを参照してください](https://www.microsoft.com/trust-center/privacy)。


1. **レポート** - 結果は Security Center で確認できます。

[![Azure Security Center の組み込みの脆弱性スキャナーのプロセス フロー図](media/built-in-vulnerability-assessment/va-vm-flow-diagram.png)](media/built-in-vulnerability-assessment/va-vm-flow-diagram.png#lightbox)



## <a name="deploying-the-qualys-built-in-vulnerability-scanner"></a>Qualys の組み込み脆弱性スキャナーのデプロイ

Azure ベースの仮想マシンの脆弱性をスキャンする最も簡単な方法は、組み込み脆弱性スキャナーを使用することです。 

脆弱性スキャナー拡張機能をデプロイするには、次のようにします。

1. Azure Security Center を開き、Standard 価格レベルのサブスクリプションの **[推奨事項]** ページに進みます。

1. **[Enable the built-in vulnerability assessment solution on virtual machines (powered by Qualys)]\(組み込みの脆弱性評価ソリューションを仮想マシンで有効にする (Qualys を利用)\)** という推奨事項を選択します。

    [![フィルター処理されて Qualys の推奨事項が表示されている Azure Security Center の [推奨事項] ページ](media/built-in-vulnerability-assessment/va-recommendations-enable-selected.png)](media/built-in-vulnerability-assessment/va-recommendations-enable-selected.png#lightbox)

    VM は、次の 1 つ以上のグループに表示されます。

    * **正常なリソース** – 脆弱性スキャナー拡張機能は、これらの VM にデプロイされています。
    * **問題のあるリソース**　-　これらの VM には、脆弱性スキャナー拡張機能をデプロイできます。 
    * **適用できないリソース** - これらの VM では、脆弱性スキャナー拡張機能をデプロイできません。 VM がこのタブに表示されるのは、Free 価格レベルであるか、ImageReference クラス ([この.NET 向けの Azure ページ](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.imagereference?view=azure-dotnet)で説明されているように、バックアップから復元されたカスタム イメージと VM に関連する) が存在しないか、サポートされている次の OS のいずれかを実行していないためです。


        | **ベンダー名** | **OS** | **サポートされているバージョン** |
        |----|----|----|
        |Microsoft|Windows|All|
        |Red Hat|Enterprise Linux|5.4+、6、7.0-7.7、8|
        |Red Hat|CentOS|5.4+、6、7.0-7.7|
        |Red Hat|Fedora|22-25|
        |SUSE|Linux Enterprise Server (SLES)|11、12、15|
        |SUSE|OpenSUSE|12、13|
        |SUSE|Leap|42.1|
        |Oracle|Enterprise Linux|5.11、6、7.0-7.5|
        |Debian|Debian|7.x-9.x|
        |Ubuntu|Ubuntu|12.04 LTS、14.04 LTS、15.x、16.04 LTS、18.04 LTS|

1. [Unhealthy resources]\(正常でないリソース\) タブで、Qualys スキャナーをデプロイする VM を選択し、 **[修復]** をクリックします。 

    ![Qualys スキャナーに対する VM の選択](media/built-in-vulnerability-assessment/va-remediating.png)

    スキャナー拡張機能が、選択したすべての VM にインストールされます。
    
    拡張機能が正常にデプロイされるとすぐに、スキャンが自動的に開始されます。 スキャンはその後、4 時間間隔で実行されます。 この間隔はハードコーディングされており、構成することはできません。 

1. 1つ以上の VM でデプロイが失敗した場合は、ターゲット VM が次の 2 つの IP アドレスで Qualys のクラウド サービスと通信できることを確認します (ポート 443 経由 - HTTPS の規定値)。

    - 64.39.104.113
    - 154.59.121.74 


## <a name="viewing-and-remediating-discovered-vulnerabilities"></a>検出された脆弱性の表示と修復

Security Center で脆弱性が識別されると、検出結果と推奨事項としての関連情報が提示されます。 関連情報には、修復手順、関連する CVE、CVSS のスコアなどが含まれます。 1 つ以上のサブスクリプション、または特定の VM で識別された脆弱性を表示することができます。

検出された脆弱性を確認して修復するには、次のようにします。

1. Azure Security Center を開き、 **[推奨事項]** ページに進みます。 

1. [仮想マシンで検出された脆弱性を修復する (Qualys を利用)] を選択します。

    Security Center に、現在選択されているサブスクリプションのすべての VM に関する検出結果がすべて表示されます。 検出結果は重要度順に並んでいます。 

    [![選択されたすべてのサブスクリプションに関する Qualys からの検出結果の一覧](media/built-in-vulnerability-assessment/va-findings-all.png)](media/built-in-vulnerability-assessment/va-findings-all.png#lightbox)

1. 特定の VM で検出結果をフィルターに掛けるには、[影響を受けるリソース] セクションを開き、目的の VM をクリックします。 または、リソースの正常性ビューから VM を選択し、そのリソースに関連するすべての推奨事項を表示できます。

    Security Center に、その VM の検出結果が重要度順に表示されます。 

    [![特定の仮想マシンに関する検出結果](media/built-in-vulnerability-assessment/va-findings.png)](media/built-in-vulnerability-assessment/va-findings.png#lightbox)

    この例では、94 個の脆弱性が検出され、そのうち 5 個が中程度の重大度であることがわかります。

1. 特定の脆弱性の詳細を確認するには、それを選択します。 

    [![脆弱性 #91426 の詳細ペイン](media/built-in-vulnerability-assessment/va-vulnerability-details.png)](media/built-in-vulnerability-assessment/va-vulnerability-details.png#lightbox)

    表示される詳細ペインには、次のような脆弱性に関する広範な情報が含まれています。
    
    * 関連するすべての CVE へのリンク (使用可能な場合)
    * 修復手順
    * その他の参照ページ

1. 検出結果を修復するには、この詳細ペインの修復手順に従います。



## <a name="exporting-results"></a>結果のエクスポート

脆弱性評価の結果をエクスポートするには、[Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/) (ARG) を使用する必要があります。 このツールでは、堅牢なフィルター処理、グループ化、および並べ替え機能を使用して、クラウド環境全体のリソース情報にすばやくアクセスできます。 これは、Azure サブスクリプション全体の情報を、プログラムから、または Azure portal 内ですばやく効率的に照会する方法です。

完全な手順とサンプルの ARG クエリについては、次の技術コミュニティの投稿を参照してください: 「[Exporting Vulnerability Assessment Results in Azure Security Center](https://techcommunity.microsoft.com/t5/azure-security-center/exporting-vulnerability-assessment-results-in-azure-security/ba-p/1212091)」 (Azure Security Center での脆弱性評価の結果のエクスポート)。


## <a name="built-in-qualys-vulnerability-scanner-faq"></a>組み込み Qualys 脆弱性スキャナーに関するよくあるご質問

### <a name="are-there-any-additional-charges-for-the-qualys-license"></a>Qualys ライセンスに対して追加料金は発生しますか?
いいえ。 すべての Standard レベルのユーザーが、組み込みスキャナーを無料でご利用いただけます。 [Enable the built-in vulnerability assessment solution on virtual machines (powered by Qualys)]\(組み込みの脆弱性評価ソリューションを仮想マシンで有効にする (Qualys を利用)\) という推奨事項でデプロイされるスキャナーには、ライセンスと構成情報が含まれています。 追加のライセンスは必要ありません。 

### <a name="what-prerequisites-and-permissions-are-required-to-install-the-qualys-extension"></a>Qualys 拡張機能をインストールするために必要な前提条件とアクセス許可は何ですか。
拡張機能をデプロイするすべての VM に対する書き込みアクセス許可が必要です。

Azure Security Center 脆弱性評価拡張機能 (Qualys を利用) は、他の拡張機能と同様に、Azure 仮想マシン エージェント上で実行されます。 つまり、Windows ではローカル ホストとして、Linux では Root として実行されます。

セットアップ中、Security Center では、次の 2 つの IP アドレスで VM が Qualys のクラウド サービスと通信できることを確認します (ポート 443 経由 - HTTPS の規定値)。

- 64.39.104.113
- 154.59.121.74


### <a name="can-i-remove-the-security-center-qualys-extension"></a>Security Center の Qualys 拡張機能を削除できますか? 
VM から拡張機能を削除する場合は、手動で、または任意のプログラム ツールを使用して実行できます。 

次の詳細情報が必要になります。

* Linux では、拡張機能は "LinuxAgent.AzureSecurityCenter" と呼ばれ、プロバイダー名は "Qualys" です。
* Windows では、拡張機能は "WindowsAgent.AzureSecurityCenter" と呼ばれ、プロバイダー名は "Qualys" です。

### <a name="how-does-the-extension-get-updated"></a>拡張機能の更新はどのように行われますか?
Azure Security Center エージェント自体およびその他すべての Azure 拡張機能と同様に、Qualys スキャナーのマイナー更新はバックグラウンドで自動的に行われる場合があります。 すべてのエージェントと拡張機能は、自動的にデプロイされる前に広範囲にわたってテストされます。

### <a name="why-does-my-vm-show-as-not-applicable-in-the-recommendation"></a>推奨事項で VM が「適用できません」と表示されるのはなぜですか？
「**仮想マシンでの組み込みの脆弱性評価ソリューションの有効化 (Qualys により提供)** 」の推奨事項の [推奨事項の詳細] ページでは、VM を次のリストのうち 1 つ以上にグループ化します。**正常なリソース**、**問題のあるリソース**、および**適用できないリソース**。

**適用できないリソース** グループに VM がある場合は、Security Center がその VM に脆弱性スキャナー拡張機能をデプロイできないことを意味します。 

次の理由により、VM がこのタブに表示される場合があります。

- Free 価格レベルである。前述のように、Azure Security Center に含まれる脆弱性スキャナーは、Standard 価格レベルのユーザーのみご利用いただけます。

- ImageReference クラス ([こちらの Azure for .NET ページ](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.imagereference?view=azure-dotnet)で説明されているように、バックアップから復元されたカスタム イメージと VM に関連する) が存在しない。

- サポートされているいずれかの OS が実行されていない。

    | **ベンダー名** | **OS** | **サポートされているバージョン** |
    |----|----|----|
    |Microsoft|Windows|All|
    |Red Hat|Enterprise Linux|5.4+、6、7.0-7.7、8|
    |Red Hat|CentOS|5.4+、6、7.0-7.7|
    |Red Hat|Fedora|22-25|
    |SUSE|Linux Enterprise Server (SLES)|11、12、15|
    |SUSE|OpenSUSE|12、13|
    |SUSE|Leap|42.1|
    |Oracle|Enterprise Linux|5.11、6、7.0-7.5|
    |Debian|Debian|7.x-9.x|
    |Ubuntu|Ubuntu|12.04 LTS、14.04 LTS、15.x、16.04 LTS、18.04 LTS|

### <a name="what-is-scanned-by-the-built-in-vulnerability-scanner"></a>組み込みの脆弱性スキャナーでは何がスキャンされますか?
スキャナーは仮想マシンで実行されており、その VM 自体の脆弱性を探します。 仮想マシンからネットワークをスキャンすることはできません。

### <a name="does-the-scanner-integrate-with-my-existing-qualys-console"></a>スキャナーは既存の Qualys コンソールと統合されますか?
Security Center 拡張機能は、既存の Qualys スキャナーとは別のツールです。 ライセンス制限は、Azure Security Center 内でのみ使用できることを意味します。

### <a name="microsoft-defender-advanced-threat-protection-also-includes-threat--vulnerability-management-tvm-how-is-the-security-center-vulnerability-assessment-extension-different"></a>Microsoft Defender Advanced Threat Protection にも、脅威および脆弱性管理 (TVM) が含まれています。 Security Center 脆弱性評価拡張機能はどのように異なりますか?
Microsoft では、Windows に組み込まれている Microsoft Defender ATP の脅威および脆弱性管理ソリューションを使用して、世界クラスの脆弱性管理を積極的に開発しています。

現在、Azure Security Center の脆弱性評価拡張機能では Qualys を利用しています。 Qualys の拡張機能により、Windows と Linux 両方の VM が確実にサポートされます。 また、この拡張機能は、まだ CVE を持たない脆弱性に関する Qualys 独自の知識の恩恵も得ることができます。

## <a name="next-steps"></a>次のステップ
この記事では、VM をスキャンするための Azure Security Center 脆弱性評価拡張機能 (Qualys を利用) について説明しました。 関連資料については、次の記事をご覧ください。

- [推奨事項のさまざまな要素に関する詳細](security-center-recommendations.md)
- [推奨事項を修復する方法を確認する](security-center-remediate-recommendations.md)