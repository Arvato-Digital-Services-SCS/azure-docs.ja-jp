---
title: データのラベルを取得する
titleSuffix: Azure Machine Learning
description: この記事では、ラベル付けプロジェクトを作成して実行し、機械学習用のデータにタグを付ける方法について説明します。
author: lobrien
ms.author: laobri
ms.service: machine-learning
ms.topic: tutorial
ms.date: 11/04/2019
ms.openlocfilehash: 76f995901814c90ff9fd78585c98d56b3478e8b4
ms.sourcegitcommit: b2fb32ae73b12cf2d180e6e4ffffa13a31aa4c6f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/05/2019
ms.locfileid: "73612764"
---
# <a name="get-labels-for-data"></a>データのラベルを取得する

大量のデータにラベルを付けることは、多くの場合、機械学習プロジェクトでは困難でした。 画像の分類やオブジェクトの検出など、Computer Vision コンポーネントを使用する ML プロジェクトでは、通常、何千ものイメージとそれに対応するラベルが必要です。 
 
Azure Machine Learning Studio を使用すると、ラベル付けプロジェクトの作成、管理、監視を一元的に行うことができます。 ラベル付けプロジェクトは、データ、ラベル、チーム メンバーの間の調整に役立ち、ラベル付けタスクをより効率的に管理できるようになります。 現在サポートされているタスクは、複数ラベルまたは多クラスでの画像分類と、境界ボックスを使用したオブジェクト識別です。

Azure を使うと、進行状況を追跡し、未完了のラベル付けタスクのキューを維持することができます。 ラベラーは、Azure アカウントがなくても参加できます。 Microsoft アカウント (MSA) または [Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-whatis) での認証が済むと、時間が許す範囲で、どれだけ多くても、または少なくても、ラベル付けを行うことができます。 キーボード ショートカットを使って、ラベルを割り当てたり、変更したりできます。 

プロジェクトの開始と停止、ユーザーやチームの追加と削除、進行状況の監視を行うことができます。 ラベル付けされたデータは、COCO 形式または Azure ML データセットとしてエクスポートできます。 

この記事では、以下の方法について説明します。

> [!div class="checklist"]
> * プロジェクトの作成
> * プロジェクトのデータと構造を指定する
> * プロジェクトで作業するチームとユーザーを管理する
> * プロジェクトを実行して監視する
> * ラベルをエクスポートする 

## <a name="prerequisites"></a>前提条件

* ローカル ファイルまたは既に Azure Storage 内にある、ラベル付け対象のデータ
* 適用するラベルのセット
* ラベル付けの指示
* Azure サブスクリプション。 Azure サブスクリプションをお持ちでない場合は、開始する前に無料アカウントを作成してください。 [無料版または有料版の Azure Machine Learning](https://aka.ms/AMLFree) を試してください
* Azure Machine Learning ワークスペース。 [Azure Machine Learning ワークスペースを作成する](how-to-manage-workspace.md)方法に関するページを参照してください。

## <a name="create-a-labeling-project"></a>ラベル付けプロジェクトを作成する

ラベル付けプロジェクトは、[Azure Machine Learning Studio](https://ml.azure.com/) から管理します。 **[Labeling projects]\(ラベル付けプロジェクト\)** ページでは、プロジェクト、チーム、ユーザーを管理できます。 プロジェクトには 1 つまたは複数のチームが割り当てられ、チームには 1 人以上のユーザーが割り当てられます。 

データが Azure Blob Storage に既に格納されている場合は、ラベル付けプロジェクトを作成する前に、それをデータストアとして使用できるようにする必要があります。 詳しくは、「[データストアの作成と登録](https://docs.microsoft.com/azure/machine-learning/service/how-to-access-data#create-and-register-datastores)」をご覧ください。 

プロジェクトを作成するには、 **[プロジェクトの追加]** を選択します。 適切な名前を指定し、 **[Labeling task type]\(ラベル付けタスクの種類\)** を選択します。 

![ラベル付けプロジェクト作成ウィザード](media/how-to-create-labeling-projects/labeling-creation-wizard.png)

* クラスのセットから **1 つ "_または複数_"** のラベルを画像に適用できるプロジェクトの場合は、 **[Image Classification Multi-label]\(イメージ分類複数ラベル\)** を選択します。 たとえば、犬の写真には "*犬*" と "*日中*" の両方のラベルが付けられる可能性があります
* クラスのセットから **1 つのクラス**だけを画像に適用できるプロジェクトの場合は、 **[Image Classification Multi-class]\(画像分類多クラス\)** を選択します
* 画像内のオブジェクトへのクラスの割り当てと、そのオブジェクトを囲む境界ボックスの指定の両方がタスクであるプロジェクトの場合は、 **[Object Identification (Bounding Box)]\(オブジェクト識別 \(境界ボックス\)\)** を選択します

先に進む準備ができたら、 **[次へ]** を選択します。

## <a name="specify-data-to-be-labeled"></a>ラベルを付けるデータを指定する

データが含まれるデータセットを既に作成してある場合は、 **[Select an existing dataset]\(既存のデータセットの選択\)** ドロップダウンから選択できます。 または、 **[Create a dataset]\(データセットの作成\)** を選択して、既存の Azure データストアを選択するか、ローカル ファイルをアップロード ます。 

### <a name="create-a-dataset-from-an-azure-datastore"></a>Azure データストアからデータセットを作成する

ローカル ファイルの直接アップロードを選択すれば多くのユースケースで問題ありませんが、大量のデータを転送する場合は [Azure Storage Explorer](https://azure.microsoft.com/features/storage-explorer/) がより堅牢で高速です。 既定のファイル移動方法としては、Azure Storage Explorer をお勧めします。

Azure Blob Storage に既に格納されているデータからデータセットを作成するには:

1. **[Create a dataset]\(データセットの作成\)** と **[From datastore]\(データストアから\)** を選択します
1. データセットの **[名前]** を指定します
1. **[Dataset type]\(データセットの種類\)** として、[ファイル] を選択する必要があります  
1. データセットを選択します 
1. データが Blob Storage 内のサブフォルダーにある場合は、 **[参照]** を選択してパスを選択します。 
    * パスの後に `/**` を追加することで、選択したパスのサブフォルダー内のすべてのファイルを含めることができます
    * 現在のコンテナーとサブフォルダー内のすべてのデータを含めるには、`**/*.*` を使用します
1. データセットの説明を指定します
1. **[次へ]** を選択します 
1. 詳細を確認します。 **[戻る]** を選択すると設定を変更でき、 **[作成]** を選択するとデータセットを作成できます

### <a name="create-a-dataset-by-uploading-data"></a>データをアップロードしてデータセットを作成する

データを直接アップロードする場合:

1. **[Create a dataset]\(データセットの作成\)** と **[From local files]\(ローカル ファイルから\)** を選択します
1. データセットの **[名前]** を指定します
1. **[Dataset type]\(データセットの種類\)** として、[ファイル] を選択する必要があります
1. **[Advanced settings]\(詳細設定\)** を選択した場合は、データストア、コンテナー、およびデータへのパスをカスタマイズできます
1. **[参照]** を選択して、アップロードするローカル ファイルを選択します
1. データセットの説明を指定します
1. **[次へ]** を選択します 
1. 詳細を確認します。 **[戻る]** を選択すると設定を変更でき、 **[作成]** を選択するとデータセットを作成できます

データが、Azure ML ワークスペースの既定の BLOB ストア (`workspaceblobstore`) にアップロードされます。

## <a name="specify-label-classes"></a>ラベル クラスを指定する

**[Label classes]\(ラベル クラス\)** ページで、データの分類に使用するクラスのセットを指定します。 これらのクラスについては熟考してください。適切なクラスを簡単に選択できるかどうかは、ラベラーの正確さと速さに影響します。 たとえば、植物や動物の属や種を略さずに使用するより、フィールド コードや種の略称を使う方がよい場合があります。 

行ごとに 1 つのラベルを入力し、 **[+]** ボタンを使用して新しい行を追加します。 ラベルの数が 3 または 4 以上で 10 未満の場合は、"1:"、"2:" などのプレフィックスを付けることを考えます。このようにすると、数値キーを使って作業効率を高めるラベラーにガイダンスを提供することができます。 

## <a name="describe-the-labeling-task"></a>ラベル付けタスクを説明する

ラベル付けタスクをわかりやすく説明することが重要です。 **[Labeling instructions]\(ラベル付けの指示\)** ページを使うと、外部サイトにリンクして、ラベラーへの指示を提供できます。 指示は、タスク指向で、対象ユーザーに適したものにします。 

* どのようなラベルが表示され、どのような方法で選択しますか。 参照する必要のある参照テキストはありますか。
* 適切なラベルが見あたらない場合はどうすればよいですか。 
* 適切に見えるラベルが複数ある場合はどうすればよいですか。
* どのような信頼度しきい値をラベルに適用する必要がありますか。 確実にわからない場合は、"最善の推測" で選択させますか。
* 対象のオブジェクトが部分的にオクルージョンされている場合、または重なっている場合は、どうすればよいですか。
* 対象のオブジェクトが画像の端によってクリップされている場合は、どうすればよいですか。
* 送信してしまってから画像に間違いがあったことに気付いた場合は、どうすればよいですか。 

境界ボックスでは、他に次のような重要な問題があります。

* このタスクでは境界ボックスはどのように定義されていますか。 オブジェクトの内部に完全に配置するか、その範囲にできるだけ近いサイズにトリミングする必要がありますか、または隙間があってもかまいませんか。 
* 境界ボックスの定義に対してラベラーがどの程度の注意と一貫性を適用することが期待されますか。

>[!Note]
> ラベラーは最初の 9 つのラベルを 1 から 9 の数字キーで選択できることを忘れずに伝えます。 

## <a name="initialize-the-labeling-project"></a>ラベル付けプロジェクトを初期化する

初期化が済むと、ラベル付けプロジェクトのいくつかの部分は変更できなくなります。タスクの種類やデータセットを変更することはできません。 ラベルや、タスクの説明の URL は変更できます。 プロジェクトを作成する前に、設定を慎重に確認してください。 プロジェクトを送信すると、 **[Labeling]\(ラベル付け\)** ホーム ページに戻り、プロジェクトが **[Initializing]\(初期化中\)** と表示されます。 このページは自動的に更新されないので、しばらくして手動で更新すると、プロジェクトは **[Created]\(作成済み\)** と表示されます。 

## <a name="manage-teams-and-people"></a>チームとユーザーを管理する

ラベル付けプロジェクトでは既定のチームが作成され、作成者は既定のメンバーとして追加されます。 ラベル付けプロジェクトごとに新しい既定のチームが作成されますが、チームはプロジェクト間で共有できます。 プロジェクトでは複数のチームを使用できます。 チームの作成は、 **[Teams]\(チーム\)** ページの **[Add team]\(チームの追加\)** を選択して行います。 

ユーザーは、 **[People]\(ユーザー\)** ページで管理します。 ユーザーの追加と削除は、メール アドレスをキーにして行うことができます。 各ラベラーは、Microsoft アカウントまたは Azure Active Directory (使用している場合) を使用して、認証を行う必要があります。  

追加したユーザーは、1 つ以上のチームに割り当てることができます。 **[Teams]\(チーム\)** ページに移動し、対象の特定のチームを選択してから、必要に応じて **[Assign people]\(ユーザーの割り当て\)** または **[Remove people]\(ユーザーの削除\)** を使用します。

チームの全員にメールを送信する場合は、チームを選択して **[Team details]\(チームの詳細\)** ページを表示します。 このページの **[Email team]\(チームへのメール送信\)** ボタンをクリックすると、チームの全員のアドレスが設定されたメール エディターが開きます。

## <a name="run-and-monitor-the-project"></a>プロジェクトを実行して監視する

プロジェクトが初期化されると、Azure によって実行が開始されます。 メインの **[Labeling]\(ラベル付け\)** ページでプロジェクトをクリックすると、 **[Project details]\(プロジェクトの詳細\)** が表示されます。 **[Dashboard]\(ダッシュボード\)** タブには、ラベル付けタスクの進行状況が表示されます。 

**[Data]\(データ\)** タブでは、データセットを調べて、ラベル付けされたデータを確認できます。 不適切なラベル付けのデータがある場合は、それを**選択**して **[Reject]\(拒否\)** を選択することで、ラベルを削除し、データを未ラベル付けキューに戻すことができます。 

**[Team]\(チーム\)** タブでは、このプロジェクトに対するチームの割り当てまたは割り当て解除を行うことができます。 

プロジェクトをオフラインまたはオンラインにする場合は、 **[Pause]\(一時停止\)** / **[Start]\(開始\)** ボタンを選択して、プロジェクトの実行状態を切り替えます。

**[Project details]\(プロジェクトの詳細\)** ページで **[Label data]\(データのラベル付け\)** を選択することにより、データに直接ラベルを付けることができます。 データにラベルを付けることができるのは、プロジェクトが実行されているときだけです。 

## <a name="export-the-labels"></a>ラベルをエクスポートする

いつでも、機械学習の実験用にラベル データをエクスポートできます。 画像のラベルは、[COCO 形式](http://cocodataset.org/#format-data)または Azure ML データセットとしてエクスポートできます。 ラベル付けプロジェクトの **[Project details]\(プロジェクトの詳細\)** ページに **[Export]\(エクスポート\)** ボタンがあります。

COCO ファイルは、**export/coco** 内のフォルダーの、Azure ML ワークスペースの既定の BLOB ストアに作成されます。 エクスポートされた Azure ML データセットには、Studio の **[Datasets]\(データセット\)** セクションでアクセスできます。 データセットの詳細ページには、Python からラベルにアクセスするためのサンプル コードも用意されています。

![エクスポートされたデータセット](media/how-to-create-labeling-projects/exported-dataset.png)

## <a name="next-steps"></a>次の手順

* [画像の分類またはオブジェクトの検出](how-to-label-images.md)のために、画像にラベルを付けます
* [Azure Machine Learning と Studio](../compare-azure-ml-to-studio-classic.md) についてさらに詳しく学習します