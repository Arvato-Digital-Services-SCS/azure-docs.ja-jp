---
title: Azure Front Door - ワイルドカード ドメインのサポート
description: この記事では、カスタム ドメインの一覧におけるワイルドカード ドメインのマッピングや管理が、Azure Front Door でどのようにサポートされるかについて説明します
services: frontdoor
author: sharad4u
ms.service: frontdoor
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/10/2020
ms.author: sharadag
ms.openlocfilehash: c568c9cc5c57098385cc7399459ec656cdbfc305
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/28/2020
ms.locfileid: "79540963"
---
# <a name="wildcard-domains"></a>ワイルドカード ドメイン

頂点ドメインとサブドメイン以外に、Front Door プロファイルのフロントエンド ホストやカスタム ドメインの一覧に、ワイルドカード ドメイン名をマップすることもできます。 Front Door の構成でワイルドカード ドメインを使用すると、API、アプリケーション、または Web サイト用の複数のサブドメインに対するトラフィック ルーティングの動作を、同じルーティング規則によって簡素化することができます。これにより、構成を変更して各サブドメインの追加や指定を個別に行う手間を省くことができます。 たとえば、ワイルドカード ドメイン `*.contoso.com`を追加することで、`customer1.contoso.com`、`customer2.contoso.com`、および `customerN.contoso.com` のルーティングを、同じルーティング規則で定義することができます。

ワイルドカード ドメインがサポートされたことで解決される主なシナリオとしては、次のようなものがあります。

- 各サブドメインをフロント ドアにオンボードし、HTTPS を有効にして各サブドメインの証明書をバインドする必要がなくなりました。
- アプリケーションで新しいサブドメインが追加された場合に、運用中の Front Door 構成を変更する必要がなくなりました。 以前は、サブドメインを追加し、それに証明書をバインドし、Web アプリケーション ファイアウォール (WAF) ポリシーをアタッチして、ドメインを個別のルーティング規則に追加する必要がありました。

> [!NOTE]
> 現在のところ、ワイルドカード ドメインは API、PowerShell、CLI でのみサポートされています。 Azure portal を通じてワイルドカード ドメインを追加、管理することはサポートされていません。

## <a name="adding-wildcard-domains"></a>ワイルドカード ドメインの追加

ワイルドカード ドメインは、[フロントエンド ホスト] セクションまたは [ドメイン] セクションでオンボードできます。 Front Door では、サブドメインと同様、ワイルドカード ドメインについても、CNAME マッピングがあることが検証されます。 この DNS マッピングは、`contoso.azurefd.net` にマップされた `*.contoso.com` のように直接の CNAME マッピングにすることもでき、`afdverify.contoso.azurefd.net` にマップされた `afdverify.contoso.com` のように、afdverify 一時マッピングを経由してワイルドカードの CNAME マップを検証するようにすることもできます (Azure DNS では、ワイルドカード レコードがサポートされています)。

また、フロントエンド ホストの最大制限数に達しない範囲であれば、ワイルドカード ドメインの単一レベルのサブドメインをフロントエンド ホストに複数追加することもできます。 この機能は、あるサブドメインに対して (ワイルドカード ドメイン内の) 他のドメインとは異なるルートを定義する場合や、特定のサブドメインに対して異なる WAF ポリシーを設定する場合に必要になる可能性があります。 つまり、`*.contoso.com` を使用すると、ドメインの所有権を再度証明しなくても、`foo.contoso.com` を追加することができます。ただし、`foo.bar.contoso.com` は `*.contoso.com` の単一レベルのサブドメインではないので、同様に追加することはできません。 ドメイン所有権の追加検証を行わずに `foo.bar.contoso.com` を追加するには、`*.bar.contosonews.com` を追加する必要があります。

### <a name="limitations"></a>制限事項

1. ある Front Door プロファイルにワイルドカード ドメインが追加された場合、同じワイルドカード ドメインを他の Front Door プロファイルに追加することはできません。 
2. ある特定の Front Door プロファイルにワイルドカード ドメインが追加された場合、そのワイルドカード ドメインのサブドメインを、他の Front Door プロファイルや Microsoft Azure CDN プロファイルに追加することはできません
3. ワイルドカード ドメインのサブドメインが Front Door プロファイルまたは Microsoft Azure CDN プロファイルに追加された場合、そのワイルドカード ドメインを他の Front Door プロファイルに追加することはできません。 
4. 2 つのプロファイル (Front Door または Microsoft Azure CDN) にルート ドメインのサブドメインが複数ある場合は、どちらのプロファイルにも、ワイルドカード ドメインを追加することはできません。

## <a name="certificate-binding-for-wildcard-domains-and-its-subdomains"></a>ワイルドカード ドメインとそのサブドメインの証明書バインド

ワイルドカード ドメインで HTTPS トラフィックを受け入れるには、ワイルドカード ドメインで HTTPS を有効にする必要があります。 ワイルドカード ドメインの証明書バインドには、ワイルドカード証明書が必要です。つまり、証明書のサブジェクト名にも、ワイルドカード ドメインを使用する必要があります。

> [!NOTE]
> 現在のところ、ワイルドカード ドメインに対して HTTPS を有効にするには、独自のカスタム SSL 証明書を使用するオプションしかありません。 Front Door で管理される証明書は、ワイルドカード ドメインには使用できません。 

サブドメインには、キー コンテナーから同じワイルドカード証明書を使用することもでき、Front Door で管理される証明書をサブドメイン用に使用することもできます。
ワイルドカード ドメインにサブドメインが追加され、そのワイルドカード ドメインに既に証明書が関連付けられている場合、このサブドメインの HTTPS を無効にすることはできません。 このサブドメインでは、別の Key Vault 証明書や、Front Door で管理される証明書によって上書きされない限り、ワイルドカード ドメインの証明書バインドが既定で使用されます。

## <a name="web-application-firewall-for-wildcard-domains-and-its-subdomains"></a>ワイルドカード ドメインとそのサブドメインの Web アプリケーション ファイアウォール

WAF ポリシーは、他のドメインと同様に、ワイルドカード ドメインにもアタッチできます。 ワイルドカード ドメインのサブドメインに、別の WAF ポリシーを適用することもできます。 サブドメインについては、ワイルドカード ドメインと同じポリシーを使用する場合であっても、使用する WAF ポリシーを明示的に指定する必要があります。 サブドメインでは、ワイルドカード ドメインから WAF ポリシーが自動的に継承されることは**ありません**。

サブドメインに対して WAF を実行したくない場合は、管理対象やカスタムのルールセットを含まない、空の WAF ポリシーを作成することもできます。

## <a name="routing-rules-for-wildcard-domains-and-its-subdomains"></a>ワイルドカード ドメインとそのサブドメインのルーティング規則

ルーティング規則を構成する際には、フロントエンド ホストとしてワイルドカード ドメインを選択できます。 また、ワイルドカード ドメインとサブドメインに対し、それぞれ異なるルート動作を適用することもできます。 「[Front Door が要求をルーティング規則と照合する方法](front-door-route-matching.md)」で説明されているように、ドメインに対してどのルーティング規則が最も適合するかは、実行時に選択されます。

> [!WARNING]
> たとえば、**ルート 1**: バックエンド プール A にマップされた `*.foo.com/*` と、**Route 2**: バックエンド プール B にマップされた `bar.foo.com/somePath/*` という 2 つのルーティング規則があった場合、`bar.foo.com/anotherPath/*` に対する要求が受信されると、Front Door がどちらのルートにも適合性を検出できず、クライアントでエラーが表示されます。 Front Door では、[ルート照合アルゴリズム](front-door-route-matching.md)に従って、ルート 2 のほうがよりドメインに適合しているという判断はされますが、一致するパス パターンがないため、エラーになります。 


## <a name="next-steps"></a>次のステップ

- [フロント ドアの作成](quickstart-create-front-door.md)方法について学習します。
- [Front Door にカスタム ドメインを追加する](front-door-custom-domain.md)方法について学習します。
- [カスタム ドメインで HTTPS を有効にする方法](front-door-custom-domain-https.md)について学習します。
