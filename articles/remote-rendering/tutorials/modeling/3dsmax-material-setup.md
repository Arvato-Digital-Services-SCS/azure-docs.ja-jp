---
title: 3DSMax で物理ベース レンダリング素材を設定する
description: 3DSMax で物理ベース レンダリング素材を設定し、FBX 形式でエクスポートする方法について説明します。
author: muxanickms
ms.author: misams
ms.date: 06/16/2020
ms.topic: tutorial
ms.openlocfilehash: df4be8963c93199f9fad23ab3f709f691e1da768
ms.sourcegitcommit: 9b5c20fb5e904684dc6dd9059d62429b52cb39bc
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/02/2020
ms.locfileid: "85857614"
---
# <a name="tutorial-set-up-physically-based-rendering-materials-in-3d-studio-max"></a>チュートリアル:3D Studio Max で物理ベース レンダリング素材を設定する

## <a name="overview"></a>概要
このチュートリアルで学習する内容は次のとおりです。

>[!div class="checklist"]
>
> * 高度なライティングが施された素材をシーン内のオブジェクトに割り当てる。
> * オブジェクトと素材のインスタンス化を処理する。
> * シーンを FBX 形式でエクスポートし、重要なオプションを選択する。

3D Studio Max (3DSMax) で[物理ベース レンダリング (PBR) 素材](../../overview/features/pbr-materials.md)を作成するのは比較的簡単な作業です。 Maya のような他のコンテンツ作成アプリでの PBR 設定と多くの点で似ています。 このチュートリアルは、Azure Remote Rendering プロジェクトの基本的な PBR シェーダー設定と FBX エクスポートに関するガイドです。

このチュートリアルのサンプル シーンには、いくつかのポリゴン ボックス オブジェクトが含まれています。 これらには、木材、金属、塗装金属、プラスチック、ゴムなど、さまざまな素材が割り当てられています。 大まかに言うと、各素材には次のテクスチャのすべてまたはほとんどが含まれています。

* **Albedo (アルベド)** : 素材のカラー マップです。**Diffuse (拡散)** または **BaseColor (ベースカラー)** とも呼ばれます。
* **Metalness (メタルネス)** : 素材が金属であるかどうか、およびどのパーツが金属であるかを決定します。 
* **Roughness (粗さ)** : 表面の粗さまたは滑らかさを決定します。
また、反射のシャープネスまたはぼかしと、表面のハイライトにも影響します。
* **Normal (法線)** : ポリゴンを追加しなくても、表面にディテールを追加できます。 ディテールの例としては、金属表面のくぼみやへこみ、木目などがあります。
* **Ambient Occlusion (アンビエント オクルージョン)** : モデルにソフト シェーディングとコンタクト シャドウを追加するために使用します。 これは、モデルのどの領域が完全なライティング (白) または完全なシェード (黒) を受け取るかを示すグレースケール マップです。

## <a name="prepare-the-scene"></a>シーンを準備する
**3D Studio Max** で PBR 素材を設定するプロセスは次のとおりです。

まず、サンプル シーンでご覧のとおり、いくつかのボックス オブジェクトを作成しました。これはそれぞれ、異なる種類の素材を表します。

>[!TIP]
>ARR のアセットの作成を開始する前に、測定単位に**メートル**が使用されていることに注目してください。  
>そのため、シーンの**システム単位**を**メートル**に設定することをお勧めします。 さらに、エクスポート時には、FBX エクスポートの設定で単位をメートルに設定することをお勧めします。

次の画像は、3D Studio Max でシステム単位をメートルに設定する手順を示しています。 メイン メニューで **[Customize]\(カスタマイズ\)**  >  **[Units Setup]\(単位の設定\)**  >  **[System Units Setup]\(システム単位の設定\)** に移動し、 **[System Units Scale]\(システム単位のスケール\)** ドロップダウンで **[Meters]\(メートル\)** を選択します。 
![システム単位](media/3dsmax/system-units.jpg)

システム単位をメートルに設定したら、モデルの作成を開始できます。 このサンプル シーンでは、金属、ゴム、プラスチックなど、それぞれが異なる素材の種類を表すいくつかのボックス オブジェクトを作成します。 

>[!TIP]
>アセットを作成するときに適切な名前を付けることをお勧めします。 こうすることで、シーンに多数のオブジェクトがある場合でも後で見つけやすくなります

![オブジェクトの名前を変更する](media/3dsmax/rename-objects.jpg)

## <a name="assign-materials"></a>素材を割り当てる

シーン内にいくつかのオブジェクト (この場合はいくつかのキューブ) が作成されている状態で、PBR 設定を開始できます。

* 次の画像に示すように、メイン ツール バーの **[Material Editor]\(素材エディター\)** アイコンをクリックします。 キーボードの **M** キーを押してエディターを開くこともできます。 素材エディターには、 **[Modes]\(モード\)** ドロップダウンで選択できるモードが 2 つあります。 **[Compact material editor]\(コンパクト素材エディター\)** モードと **[Slate material]\(スレート素材\)** モードです。 このシーンは比較的単純であるため、**コンパクト モード**を使用します。

* 素材エディター内には、いくつかの球が表示されます。これらの球が素材です。 これらの素材の 1 つをシーン内の各オブジェクト (ボックス) に割り当てます。 この割り当てを行うには、まずメイン ビューポート内でオブジェクトの 1 つを選択します。 選択したら、素材エディター ウィンドウ内の最初の球をクリックします。 オブジェクトに割り当てられると、次の画像に示すように、選択した素材が強調表示されます。

* 画像に示すように、 **[Assign Material to Selection]\(素材を選択項目に割り当てる\)** ボタンをクリックします。 これで、選択した素材が選択したオブジェクトに割り当てられました。
![素材を割り当てる](media/3dsmax/assign-material.jpg)

素材エディターでは、ユース ケースに応じて、幅広い選択肢から素材の種類を選択できます。 通常、素材の種類は、既定で **[Standard]\(標準\)** に設定されています。 この素材は PBR 設定に適さない基本的な素材であるため、素材の種類を PBR 素材に変更する必要があります。 Azure Remote Rendering プロジェクトに推奨される **3DSMax** 素材は**物理素材**です。

* 素材エディターで **[Standard]\(標準\)** タブをクリックし、表示された素材またはマップ ブラウザーで **[Physical Material]\(物理素材\)** を選択します。 このアクションにより、割り当てられた **Standard (標準)** 素材が PBR **Physical Material (物理素材)** に変換されます。
![物理素材](media/3dsmax/physical-material.jpg)

* 素材エディターに物理素材のプロパティが表示されます (以下を参照)。これで、アセットへのテクスチャの割り当てを開始できます。
![テクスチャ リスト](media/3dsmax/textures-list.jpg)

上の画像からわかるように、素材に追加できるさまざまなマップとテクスチャが用意されています。 ただしここでは、目的に沿って、素材でテクスチャ スロットを 5 つだけ使用します。

>[!TIP]
>上の画像に示すように、素材に適切な名前を付けることをお勧めします。

これで、テクスチャを素材に割り当てることを検討できます。 テクスチャの生成方法は、ユーザーの好みのほか、使用法によっても異なります。 たとえば、任意のアセットに適用できるタイリング テクスチャを使用することで十分な場合もあれば、プロジェクトまたはアセットの特定の部分にテクスチャの独自のカスタム セットを必要とする場合もあります。 オンラインで入手した汎用タイリング テクスチャを使用することも、**Photoshop**、**Quixel Suite**、**Substance Suite** などのアプリを使用して自分で作成することもできます。 

ただし、テクスチャの割り当てを始める前に、アセットのテクスチャ座標 (UVW) について考慮する必要があります。 これはモデルがラップ解除されていることを確認するためにモデルにテクスチャを適用する場合のベスト プラクティスですが (UV ラップ解除を適切に行わないとテクスチャは正しく表示されません)、モデルで **Ambient Occlusion (アンビエント オクルージョン)** マップを使用する場合はこのことが重要になります。 **Maya** の **Stingray Shader (Stingray シェーダー)** とは異なり、**3DSMax** の **Physical Material (物理素材)** には専用の **Ambient Occlusion (アンビエント オクルージョン)** テクスチャ スロットがありません。 そのため、AO マップを別のスロットに適用したうえで、それを他のテクスチャ (タイリング テクスチャなど) とは別に使用できるようにするために、それ独自の UVW マップ チャネルを割り当てます。 

まず、次に示すように、モデルに **[Unwrap UVW]\(UVW をラップ解除\) 修飾子**を割り当てます。

* 選択したオブジェクトのプロパティ エディターで、[Modifier List]\(修飾子のリスト\) をクリックし、開いたドロップダウンを下へスクロールして [Unwrap UVW]\(UVW をラップ解除\) を選択します。 このアクションにより、[Unwrap UVW]\(UVW をラップ解除\) 修飾子がアセットに適用されます。
![ラップ解除修飾子](media/3dsmax/unwrap-modifier.jpg)

* マップ チャネルは 1 に設定されています。 通常、メインのラップ解除は、マップ チャネル 1 で行われます。 この例では、オブジェクトはラップ解除されており、テクスチャ座標 (UV) は重複していません。
![ラップ解除された UVW](media/3dsmax/unwrapped-uvw.jpg)

次のステップでは、2 番目の UV マップ チャネルを作成します。

* UV エディターが開いている場合は閉じ、 **[Edit UV's]\(UV の編集\)** メニューのチャネル セクションでチャネル番号を 2 に変更します。 マップ チャネル 2 は、Ambient Occlusion (アンビエント オクルージョン) マップ用として想定されるチャネルです。 

* 表示される **[Channel Change Warning]\(チャネル変更警告\)** ダイアログで、チャネル 1 の既存の UV を新しいチャネル 2 に**移動**するか、既存の UV を**破棄**して新しい **UV ラップ解除**を自動的に作成するかを選択できます。 **[Abandon]\(破棄\)** は、マップ チャネル 1 の UV とは異なるアンビエント オクルージョン マップの新しい **UV ラップ解除**を作成する場合 (たとえば、チャネル 1 でタイリング テクスチャを使用する場合) にのみ選択してください。 ここでは、新しい UV チャネルを編集する必要がないため、UV をチャネル 1 からチャネル 2 に**移動**します。

>[!NOTE]
>マップ チャネル 1 からマップ チャネル 2 に UV ラップ解除をコピー (**移動**) した場合でも、元のマップ チャネルに影響を与えることなく、新しいチャネル UV に必要な編集を加えることができます。

![チャネルの変更](media/3dsmax/channel-change.jpg)

新しいマップ チャネルが作成されたので、素材エディターの物理素材に戻り、テクスチャの追加を開始できます。 まず、アンビエント オクルージョン (**AO**) マップを追加します。これは、正常に動作させるための追加の手順があるためです。 AO マップを素材にプラグイン接続したら、マップ チャネル 2 を使用するように指示する必要があります。

* 前述したように、**3DSMax の物理素材**には、AO マップ専用のスロットはありません。 代わりに、AO マップを **[Diffuse Roughness]\(拡散の粗さ\)** スロットに適用します。

* 物理素材の **[Generic Maps]\(汎用マップ\)** リストで、 **[Diffuse Roughness]\(拡散の粗さ\)** の **[No Map]\(マップなし\)** スロットをクリックし、対象の AO マップを読み込みます。

* AO テクスチャ プロパティで、既定でマップ チャネルが **1** に設定されていることがわかります。 この値を **2** に変更します。 このアクションにより、アンビエント オクルージョン マップを追加するために必要な手順が完了します。

>[!IMPORTANT]
>これは重要な手順です。特に、チャネル 2 の UV がチャネル 1 の UV と異なる場合、間違ったチャネルを選択すると AO が正しくマッピングされないためです。

![AO マップを割り当てる](media/3dsmax/assign-ao-map.jpg)

次に、法線マップを PBR 素材に割り当てる方法について説明します。 このアクションは **Maya** とは多少異なります。つまり、法線マップは、バンプ マップ スロットに直接適用されません (そのため、**3DSMax 物理素材**には法線マップ スロットはありません)。代わりに、それ自体が **[normals]\(法線\)** スロットにプラグイン接続される法線マップ修飾子に追加されます。

* (素材エディターの) 物理素材プロパティの **[Special Maps]\(特殊なマップ\)** セクションで、 **[Bump Map]\(バンプ マップ\)** の **[No Map]\(マップなし\)** スロットをクリックします。 

* 素材またはマップ ブラウザーで、 **[Normal Bump]\(法線バンプ\)** を見つけてクリックします。 このアクションにより、 **[Normal Bump]\(法線バンプ\)** 修飾子が対象の素材に追加されます。

* **[Normal Bump]\(法線バンプ\)** 修飾子で、 **[Normal]\(法線\)** の **[No Map]\(マップなし\)** をクリックし、対象の法線マップを見つけて読み込みます。

* メソッドが (既定値の) **[Tangent]\(タンジェント\)** に設定されていることを確認し、必要に応じて **[Flip Green (Y)]\(緑 (Y) をフリップ\)** を切り替えます。

![法線バンプ](media/3dsmax/normal-bump.jpg)
![法線バンプを読み込む](media/3dsmax/load-normal-map.jpg)

法線マップが正しく割り当てられたら、残りのテクスチャを割り当てて、物理素材の設定を完了できます。 このプロセスは、考慮すべき特別な設定のない単純なプロセスです。 次の画像は、素材に割り当てられているテクスチャの完全なセットを示しています。![すべてのテクスチャ](media/3dsmax/all-textures.jpg)

PBR 素材を作成して設定したら、シーン内のオブジェクトのインスタンス化について検討します。 シーン内の類似オブジェクト (ナット、ボルト、ねじ座金など、基本的に同じオブジェクト) をインスタンス化すると、ファイル サイズの面で大幅な節約が可能になります。 マスター オブジェクトの各インスタンスには、独自のスケール、回転、変換を設定できるため、必要に応じてシーンに配置できます。 **3D Studio Max** での**インスタンス化**のプロセスは単純です。

* メイン ビューポートで、エクスポートするオブジェクトを選択します。

* 変換 (移動) ツールを使用して、**Shift** キーを押しながらアセットを上にドラッグします 

* 表示される **[Clone Options]\(複製オプション\)** ダイアログで、 **[Object]\(オブジェクト\)** を **[Instance]\(インスタンス\)** に設定し、 **[OK]** をクリックします。 
![オブジェクトをインスタンス化する](media/3dsmax/instance-object.jpg)

このアクションにより、オブジェクトのインスタンスが作成されます。これは、その親やその親の他のインスタンスとは関係なく、移動、回転、またはスケーリングできます。

>[!IMPORTANT]
>ただし、コンポーネント モードの間にインスタンスに加えた変更はすべて、オブジェクトのすべてのインスタンスに転送されます。したがって、インスタンス化されたオブジェクト コンポーネント (頂点、ポリゴン フェースなど) を操作する場合は、最初に、加える変更がこれらのすべてのインスタンスに反映されても問題がないことを確認する必要があります。 インスタンス化されたオブジェクトはいつでも一意のオブジェクトにできることに注意してください。 

>[!TIP]
>シーン内でのインスタンス化に関するベスト プラクティスは、作業を進めながら作成していくことです。それは、後で**コピー**をインスタンス化されたオブジェクトに置き換えることは非常に難しいためです。 

エクスポート プロセスに進む前に考慮すべき最後の 1 つは、共有するシーンまたはアセットをパッケージ化する方法です。 アセットをクライアントまたはチーム メンバーに渡す場合は、彼らが最小限の手間でアセットを開いて確認できるようにすることが理想的です。 したがって、アセットのテクスチャ パスをシーン ファイルに対する相対位置として保持することが重要です。 アセットのテクスチャ パスがローカル ドライブまたは絶対パスまたは場所を指していて、これを別のコンピューターで開いた場合、 **.max** ファイルがテクスチャと同じフォルダーに含まれていても、アセットはシーンに読み込まれません。 この問題は、3D Studio Max でテクスチャ パスを相対パスにすることで解決されます。その方法は非常に簡単です。

* メイン ツール バーで、 **[File]\(ファイル\)**  >  **[Reference]\(参照\)**  >  **[Asset Tracking Toggle]\(アセット追跡切り替え\)** に移動します。 

* 表示されるアセット追跡ブラウザーの **[Maps/Shaders]\(マップ/シェーダー\)** 列に、PBR 素材に適用されたすべてまたはほとんどのテクスチャが一覧表示されます。

* その横の **[Full Path]\(完全なパス\)** 列に、対象のテクスチャがある場所 (最も一般的にはローカル コンピューター上の場所) へのファイル パスが表示されます。

* 末尾には **[Status]\(状態\)** 列があります。 この列は、特定のテクスチャが検出されてシーンに適用されているかどうかを示します。このテクスチャに対して、 **[OK]** 、 **[Found]\(検出\)** 、または **[File Missing]\(ファイルが見つかりません\)** の語句で示されるフラグが設定されます。 最初の 2 つは、ファイルが見つかって読み込まれたことを示します。最後の項目は、文字どおり、トラッカーがファイルを見つけることができなかったことを意味します。
![テクスチャ パス](media/3dsmax/texture-paths.jpg)

最初にアセット トラッカーを開いたときにすべてのテクスチャがアセット トラッカーに表示されるとは限らないことに注意してください。 通常は、パス検出プロセスを 1、2 回実行するとすべてのシーン テクスチャが検出されるため、心配する必要はありません。 パス検索プロセスは次のとおりです。 

* アセット トラッカー ウィンドウで、 **[Maps/Shaders]\(マップ/シェーダー\)** リストの一番上のテクスチャを **Shift** キーを押しながら**クリック**し、Shift キーを押したままリストの最後のテクスチャをクリックします。 このアクションにより、リスト内のすべてのテクスチャが選択されます。 選択したテクスチャは青色で強調表示されます (上の画像を参照)。

* 選択項目上で右クリックし、表示されるポップアップ メニューの **[Set Path]\(パスの設定\)** を選択します。

* 表示された **[Specify Asset Path]\(アセット パスの指定\)** ボックスで、表示されたテクスチャへのローカル パスを選択し、これを `.\` に置き換えた後、 **[OK]** をクリックします。 

* (シーン内のテクスチャの数とシーンの大きさによって異なりますが) しばらくすると、アセット トラッカーが次のように解決されます (画像を参照)。
![テクスチャを解決する](media/3dsmax/resolve-textures.jpg)

**[Full Path]\(完全なパス\)** 列が空白になっていることに注意してください。 これは、シーンが特定の (絶対) 位置にある関連するテクスチャを検索する必要がなく、max ファイルまたは関連する FBX ファイルがテクスチャと同じフォルダーにある限り常に検出されることを意味します。 

>[!NOTE]
>場合によっては、すべてのテクスチャとパスを検索して解決するためにこのプロセスを数回繰り返す必要があります。 これについて心配する必要はありません。関連するすべてのアセットが考慮されるまで繰り返すのみです。 また、一部のファイルが見つからなくなる場合もあります。 この場合は、リスト内のすべてのアセットを選択し、 **[Remove Missing Paths]\(見つからないパスを削除\)** をクリックするだけです (上の画像を参照)

## <a name="fbx-export"></a>FBX エクスポート

アセット追跡が完了したら、FBX のエクスポートに進むことができます。 このプロセスも単純で、いくつかの方法で実行できます。 

>[!TIP]
>シーン全体をエクスポートする場合を除いて、必要なアセットのみをエクスポート用に選択することをお勧めします。 特にリソースが大量に使用されるシーンではエクスポートに時間がかかる場合があるため、必要なものだけをエクスポートするのが合理的です
>
>**[Turbosmooth]\(ターボスムーズ\)** や **[Open SubDiv]** などの修飾子を使用している場合はエクスポート中に問題が発生する可能性があるため、エクスポートする前にそれらを集約することをお勧めします。 この作業を行う前に必ずシーンを保存してください。 

* シーン内でエクスポートするアセットを選択します。メイン ツール バーで、 **[File]\(ファイル\)**  >  **[Export]\(エクスポート\)**  >  **[Export Selected]\(選択項目をエクスポート\)** に移動します

* **[Select File to Export]\(エクスポートするファイルの選択\)** ダイアログで、出力ファイル名を入力または選択し、 **[Save as Type]\(ファイルの種類\)** オプションで **[Autodesk (*.fbx)]** を選択します。 このアクションにより、FBX エクスポート メニューが開きます。 

* シーンにインスタンスを作成している場合は FBX エクスポート設定で **[Preserve Instances]\(インスタンスの保持\)** をオンにすることが重要であることを覚えておいてください。 
![FBX エクスポート](media/3dsmax/fbx-export.jpg)

以前に、ファイルをエクスポートする方法はいくつかあると説明しました。 エクスポートの目的が FBX をフォルダーまたはディレクトリ内のテクスチャ ファイルと共に共有することである場合は、次の画像に示されている設定で適切な結果が得られます。 設定を選択したら、 **[OK]** をクリックします。
![FBX 設定](media/3dsmax/fbx-settings.jpg)

ただし、テクスチャの大きなフォルダーまたはディレクトリを FBX と共に共有したくない場合は、FBX にテクスチャを**埋め込む**ことを選択できます。 つまり、アセット全体 (含まれているテクスチャ) が単一の FBX に追加されます。 ただし、エクスポートが単一のアセットに結合される一方で、その結果として FBX ファイルがかなり大きくなることに注意してください。

>[!IMPORTANT]
>結果の FBX ファイルが 2.4 GB より大きい場合、FBX エクスポート設定の最小バージョン (上記を参照) は 2016 以降である必要があります。 新しいバージョンでは 64 ビットのサポートがあるため、より大きなファイルがサポートされます。

* FBX エクスポート設定で、**[Embed Media]\(メディアの埋め込み\) をオンにし、 **[OK]** をクリックして、テクスチャを含めてエクスポートします。 

物理素材を使用しているときに FBX にエクスポートする場合、エクスポート ダイアログで [OK] をクリックした後に次の警告ポップアップが表示されることがあります。![エクスポート警告](media/3dsmax/export-warnings.jpg)

この警告は、エクスポートされた素材が他のソフトウェア パッケージと互換性がない可能性があることをユーザーに通知するだけです。 物理素材は Azure Remote Rendering と互換性があるため、心配する必要はありません。 **[OK]** をクリックしてプロセスを完了し、ウィンドウを閉じます。

## <a name="conclusion"></a>まとめ

一般に、この種の素材は、実際の光の物理特性をベースにしているため、より本物らしく見えます。 シーンが現実の世界に存在するかのように見せる追加の没入効果が得られます。

## <a name="next-steps"></a>次のステップ

ここまで、シーン内のオブジェクトに高度なライティングが施された素材を設定する方法を説明しました。 また、Azure Remote Rendering でサポートされている FBX 形式でオブジェクトをエクスポートする方法についても説明しました。 次の手順では、FBX ファイルを変換し、Azure Remote Rendering で視覚化します。

>[!div class="nextstepaction"]
>[クイック スタート: モデルをレンダリング用に変換する](../../quickstarts\convert-model.md)