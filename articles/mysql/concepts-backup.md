---
title: バックアップと復元 - Azure Database for MySQL
description: Azure Database for MySQL サーバーの自動バックアップと復元について説明します。
author: ajlam
ms.author: andrela
ms.service: mysql
ms.topic: conceptual
ms.date: 12/02/2019
ms.openlocfilehash: 47fa4083c26f18149b0b69b05f2cfd0b227de868
ms.sourcegitcommit: 5a71ec1a28da2d6ede03b3128126e0531ce4387d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/26/2020
ms.locfileid: "77619588"
---
# <a name="backup-and-restore-in-azure-database-for-mysql"></a>Azure Database for MySQL でのバックアップと復元

Azure Database for MySQL は、サーバーのバックアップを自動的に作成し、ユーザーが構成したローカル冗長または geo 冗長ストレージに保存します。 バックアップを使用すると、サーバーを特定の時点に復元できます。 不慮の破損または削除からデータを保護するバックアップと復元は、ビジネス継続性戦略の最も重要な部分です。

## <a name="backups"></a>バックアップ

Azure Database for MySQL では、データ ファイルとトランザクション ログのバックアップが作成されます。 サポートされている最大ストレージ サイズに応じて、完全バックアップと差分バックアップ (最大 4 TB のストレージ サーバー) またはスナップショット バックアップ (最大 16 TB のストレージ サーバー) を使用します。 これらのバックアップを使用すると、サーバーを、バックアップの構成済みリテンション期間内の任意の時点に復元できます。 バックアップの既定のリテンション期間は 7 日です。 [必要に応じて](howto-restore-server-portal.md#set-backup-configuration)最大 35 日に設定できます。 すべてのバックアップが、AES 256 ビット暗号化を使用して暗号化されます。

これらのバックアップ ファイルをエクスポートすることはできません。 バックアップは、Azure Database for MySQL の復元操作にのみ使用できます。 [mysqldump](concepts-migrate-dump-restore.md) を使用して、データベースをコピーできます。

### <a name="backup-frequency"></a>バックアップ頻度

一般に、サポートされている最大ストレージが 4 TB のサーバーについては、完全バックアップは毎週、差分バックアップは 1 日に 2 回行われます。 最大 16 TB のストレージをサポートするサーバーの場合、スナップショットバックアップは少なくとも 1 日に 1 回実行されます。 いずれの場合も、トランザクション ログ バックアップは 5 分ごとに実行されます。 完全バックアップの最初のスナップショットは、サーバーの作成直後にスケジュールされます。 復元されるサーバーが大きい場合、最初の完全バックアップに時間がかかる可能性があります。 初期の完全バックアップが完了した時点が、新しいサーバーの最も早い復元先ポイントです。 スナップショットはすぐに行われるので、最大 16 TB のストレージをサポートするサーバーを、作成時に復元することができます。

### <a name="backup-redundancy-options"></a>バックアップ冗長オプション

Azure Database for MySQL では、汎用レベルとメモリ最適化レベルで、ローカル冗長バックアップ ストレージまたは geo 冗長バックアップ ストレージのいずれかを柔軟に選択できます。 geo 冗長バックアップ ストレージにバックアップが格納されるとき、そのバックアップは、サーバーがホストされているリージョンに格納されるだけでなく、[ペアになっているデータ センター](https://docs.microsoft.com/azure/best-practices-availability-paired-regions)にもレプリケートされます。 これにより、災害発生時に、より適切な保護が提供され、別のリージョンにサーバーを復元することができます。 Basic レベルでは、ローカル冗長バックアップ ストレージのみが提供されます。

> [!IMPORTANT]
> バックアップに対してローカル冗長ストレージまたは geo 冗長ストレージを構成できるのは、サーバーの作成時だけです。 一度サーバーがプロビジョニングされると、バックアップ ストレージ冗長オプションを変更することはできません。

### <a name="backup-storage-cost"></a>バックアップ ストレージのコスト

Azure Database for MySQL は、プロビジョニングされているサーバー ストレージの 100% までをバックアップ ストレージとして追加コストなしで提供します。 通常、これは 7 日間のバックアップのリテンション期間に適しています。 バックアップ ストレージを追加で使用した場合は、GB/月単位で課金されます。

たとえば、サーバーを 250 GB でプロビジョニングした場合は、250 GB のバックアップ ストレージを追加料金なしで利用できます。 250 GB を超えたストレージ分についてのみ課金されます。

## <a name="restore"></a>[復元]

Azure Database for MySQL で復元を実行すると、元のサーバーのバックアップから新しいサーバーが作成されます。

使用できる復元には 2 つの種類があります。

- **ポイントインタイム リストア**は、いずれのバックアップ冗長オプションでも使用でき、元のサーバーと同じリージョンに新しいサーバーが作成されます。
- **geo リストア**は、サーバーを geo 冗長ストレージ用に構成した場合にのみ使用でき、ご利用のサーバーを別のリージョンに復元できます。

復旧の推定所要時間は、データベースのサイズ、トランザクション ログのサイズ、ネットワーク帯域幅、同じリージョン内で同時に復旧するデータベースの合計数など、複数の要因によって異なります。 通常は 12 時間もかかりません。

> [!IMPORTANT]
> 削除したサーバーは、復元**できません**。 サーバーを削除すると、そのサーバーに属するデータベースもすべて削除され、復元できなくなります。 管理者は、デプロイ後の誤削除や予期せぬ変更からサーバーのリソースを保護するために、[管理ロック](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-lock-resources)を利用できます。

### <a name="point-in-time-restore"></a>ポイントインタイム リストア

バックアップ冗長オプションに関係なく、バックアップのリテンション期間内の任意の時点への復元を実行できます。 新しいサーバーは、元のサーバーと同じ Azure リージョンに作成されます。 価格レベル、コンピューティング世代、仮想コア数、ストレージ サイズ、バックアップのリテンション期間、およびバックアップ冗長オプションについては、元のサーバーの構成を使用して作成されます。

ポイントインタイム リストアは複数のシナリオで役に立ちます。 たとえば、ユーザーが誤ってデータを削除したとき、重要なテーブルやデータベースを削除したとき、またはアプリケーションの不具合が原因で、適切なデータが不適切なデータで誤って上書きされた場合などです。

現時点から遡って 5 分前より後の時点に復元するには、次のトランザクション ログのバックアップが作成されるのを待たなければならない可能性があります。

### <a name="geo-restore"></a>geo リストア

geo 冗長バックアップ用にサーバーを構成した場合は、サービスを使用できる別の Azure リージョンにサーバーを復元できます。 最大 4 TB のストレージをサポートするサーバーは、geo ペアリージョンに、または 最大 16 TB のストレージをサポートする任意のリージョンに、復元することができます。 最大 16 TB のストレージをサポートするサーバーでは、16 TB のサーバーをサポートするリージョンにも、geo バックアップを復元できます。 サポートされているリージョンの一覧については、[Azure Database for MySQL の価格レベル](concepts-pricing-tiers.md)に関するページをご覧ください。

geo リストアは、サーバーがホストされているリージョンでのインシデントが原因でサーバーが利用できない場合の既定の復旧オプションです。 リージョン内の大規模なインシデントにより、データベース アプリケーションが使用できなくなった場合、geo 冗長バックアップから他の任意のリージョン内のサーバーに、サーバーを復元できます。 バックアップが取得される時刻と、別のリージョンにそのバックアップがレプリケートされる時刻には時間差があります。 この時間差は最大 1 時間なので、障害が発生した場合、最大 1 時間分のデータが損失する可能性があります。

geo リストア中に変更できるサーバー構成は、コンピューティング世代、仮想コア、バックアップの保有期間、バックアップ冗長オプションなどです。 geo リストア中の、価格レベル (Basic、汎用、またはメモリ最適化) とストレージのサイズの変更はいずれもできません。

### <a name="perform-post-restore-tasks"></a>復元後のタスクの実行

いずれかの復旧メカニズムで復元した後、ユーザーとアプリケーションを元に戻して実行するには、次のタスクを実行する必要があります。

- 元のサーバーを新しいサーバーで置き換える場合は、クライアントとクライアント アプリケーションを新しいサーバーにリダイレクトする
- ユーザーが接続できるように、適切なサーバー レベルのファイアウォール規則が適用されていることを確認する
- 適切なログインとデータベース レベルのアクセス許可が適切に指定されていることを確認する
- 必要に応じて、アラートを構成する

## <a name="next-steps"></a>次のステップ

- ビジネス継続性の詳細については、 [ビジネス継続性の概要](concepts-business-continuity.md)に関するページをご覧ください。
- Azure Portal を使用して特定の時点に復元する方法については、 [Azure Portal を使用したデータベースのポイントインタイム リストア](howto-restore-server-portal.md)に関するページをご覧ください。
- Azure CLI を使用して特定の時点に復元する方法については、 [CLI を使用したデータベースのポイントインタイム リストア](howto-restore-server-cli.md)に関するページをご覧ください。
